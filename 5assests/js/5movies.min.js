function check_login(){$.ajax({url:base_url+"ajax/load_login_status",type:"GET",dataType:"json",success:function(e){$("#top-user").html(e.content),1==e.is_login&&(is_login=!0)}})}function favorite(e,t,s){is_login?("undefined"==typeof s&&(s="add"),$(".btn-favorite-"+e).prop("disabled",!0),$(".bp-btn-like").prop("disabled",!0),$.ajax({url:base_url+"ajax/user_favorite",method:"POST",data:{movie_id:e,action:s},dataType:"json",success:function(s){$(".btn-favorite-"+e).removeAttr("disabled"),$(".bp-btn-like").removeAttr("disabled"),1==s.status&&(1==t?($("#message-content").html(s.message),$("#pop-alert").modal("show"),"user"==window.location.pathname.split("/")[1]&&$("[data-movie-id="+e+"]").addClass("ml-item-remove")):($("#favorite-alert").show(),$("#favorite-message").html(s.message),setTimeout(function(){$("#favorite-alert").hide()},5e3),$("#button-favorite").html(s.content),$(".popover-like").hide()))}})):$("#pop-login").modal("show")}function goRequestPage(e){is_login?window.location.href=e:$("#pop-login").modal("show")}function clearNotify(){var e=confirm("Are you sure delete all notify?");e&&$.ajax({url:base_url+"ajax/user_clear_notify",method:"POST",dataType:"json",success:function(e){1==e.status&&window.location.reload()}})}function loadNotify(){0==$("#list-notify .notify-item").length&&$.ajax({url:base_url+"ajax/user_load_notify",type:"GET",dataType:"json",success:function(e){1==e.status&&($("#notify-loading").remove(),$("#list-notify").html(e.html),e.notify_unread>0?$(".feed-number").text(e.notify_unread):$(".feed-number").text(""))}})}function ajaxContentBox(e){$("div#"+e+" #content-box").is(":empty")&&$.ajax({url:base_url+"ajax/get_content_box/"+e,type:"GET",dataType:"json",success:function(e){switch(e.type){case"topview-today":$("#topview-today #content-box").html(e.content);break;case"top-favorite":$("#top-favorite #content-box").html(e.content);break;case"top-rating":$("#top-rating #content-box").html(e.content);break;case"top-imdb":$("#top-imdb #content-box").html(e.content)}}})}function updateMovieView(e){$.cookie("view-"+e)||$.ajax({url:base_url+"ajax/movie_update_view",type:"POST",dataType:"json",data:{id:e},success:function(){var t=new Date,s=2;t.setTime(t.getTime()+60*s*1e3),$.cookie("view-"+e,!0,{expires:t,path:"/"})}})}function validateEmail(e){var t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return e.length>0&&t.test(e)}function subscribe(){if(!$.cookie("subscribed")){$("#error-email-subs").hide();var e=$("input[name=email]").val();""==e.trim()?($("#error-email-subs").text("Please enter your email."),$("#error-email-subs").show()):validateEmail(e)?($("#subscribe-submit").prop("disabled",!0),$("#subscribe-loading").show(),$.ajax({url:base_url+"site/subscribe",type:"POST",dataType:"json",data:{email:e},success:function(e){1==e.status&&($("#pop-subc").modal("hide"),$.cookie("subscribed",1,{expires:365,path:"/"}),$.cookie("subscribe",1,{expires:365,path:"/"})),$("#subscribe-loading").hide(),$("#subscribe-submit").removeAttr("disabled")}})):($("#error-email-subs").text("Please enter a valid email."),$("#error-email-subs").show())}}function subscribe_home(){if(!$.cookie("subscribed")){$("#error-email-subs").hide(),$("#success-subs").hide();var e=$("input[name=email-home]").val();""==e.trim()?($("#error-email-subs").text("Please enter your email."),$("#error-email-subs").show()):validateEmail(e)?($("#subscribe-submit-home").prop("disabled",!0),$.ajax({url:base_url+"site/subscribe",type:"POST",dataType:"json",data:{email:e},success:function(e){1==e.status?($("#success-subs").text("Thank you for subscribing!"),$("#success-subs").show(),$.cookie("subscribed",1,{expires:365,path:"/"}),$.cookie("subscribe",1,{expires:365,path:"/"})):($("#error-email-subs").text("Subscribe failed."),$("#error-email-subs").show()),$("#subscribe-submit-home").removeAttr("disabled")}})):($("#error-email-subs").text("Please enter a valid email."),$("#error-email-subs").show())}}function subscribe_footer(){if(!$.cookie("subscribed")){$("#error-email-subs-footer").hide(),$("#success-subs-footer").hide();var e=$("input[name=email-footer]").val();""==e.trim()?($("#error-email-subs-footer").text("Please enter your email."),$("#error-email-subs-footer").show()):validateEmail(e)?($("#subscribe-submit-footer").prop("disabled",!0),$.ajax({url:base_url+"site/subscribe",type:"POST",dataType:"json",data:{email:e},success:function(e){1==e.status?($("#success-subs-footer").text("Thank you for subscribing!"),$("#success-subs-footer").show(),$.cookie("subscribed",1,{expires:365,path:"/"}),$.cookie("subscribe",1,{expires:365,path:"/"})):($("#error-email-subs-footer").text("Subscribe failed."),$("#error-email-subs-footer").show()),$("#subscribe-submit-footer").removeAttr("disabled")}})):($("#error-email-subs-footer").text("Please enter a valid email."),$("#error-email-subs-footer").show())}}function isCookieEnabled(){var e=!!navigator.cookieEnabled;return"undefined"!=typeof navigator.cookieEnabled||e||(document.cookie="testcookie",e=-1!=document.cookie.indexOf("testcookie")),e}function searchMovie(){var e=$("input[name=keyword]").val();""!==e.trim()&&(e=e.replace(/(<([^>]+)>)/gi,"").replace(/[`~!@#$%^&*()_|\=?;:'",.<>\{\}\[\]\\\/]/gi,""),e=e.split(" ").join("+"),window.location.href=base_url+"movie/search/"+e)}function searchMovieHome(){var e=$("input[name=keyword-home]").val();""!==e.trim()&&(e=e.replace(/(<([^>]+)>)/gi,"").replace(/[`~!@#$%^&*()_|\=?;:'",.<>\{\}\[\]\\\/]/gi,""),e=e.split(" ").join("+"),window.location.href=base_url+"movie/search/"+e)}var base_url="//"+document.domain+"/";var is_login=!1;$(document).ready(function(){function e(){$(this).find(".sub-container").css("display","block")}function t(){$(this).find(".sub-container").css("display","none")}if(zy=$("body").attr("data-ts"),check_login(),$("#search a.box-title").click(function(){$("#search .box").toggleClass("active")}),$(".mobile-menu").click(function(){$("#menu,.mobile-menu").toggleClass("active"),$("#search, .mobile-search").removeClass("active")}),$(".mobile-search").click(function(){$("#search,.mobile-search").toggleClass("active"),$("#menu, .mobile-menu").removeClass("active")}),$(".filter-toggle").click(function(){$("#filter").toggleClass("active"),$(".filter-toggle").toggleClass("active")}),$(".bp-btn-light").click(function(){$(".bp-btn-light, #overlay, #media-player, #content-embed, #comment-area").toggleClass("active")}),$("#overlay").click(function(){$(".bp-btn-light, #overlay, #media-player, #content-embed, #comment-area").removeClass("active")}),$(".bp-btn-auto").click(function(){$(".bp-btn-auto").toggleClass("active")}),$("#toggle, .cac-close").click(function(){$("#comment").toggleClass("active")}),$(".top-menu> li").bind("mouseover",e),$(".top-menu> li").bind("mouseout",t),$("#slider").length>0){new Swiper("#slider",{pagination:".swiper-pagination",paginationClickable:!0,loop:!0,autoplay:4e3});$(function(){$(".tn-news, .tn-notice").perfectScrollbar()})}$("#switch-mode").click(function(){$.cookie("night-mode")?$.removeCookie("night-mode",{path:"/"}):$.cookie("night-mode",1,{expires:365,path:"/"}),location.reload()}),$.cookie("night-mode")&&$("#switch-mode").addClass("active");var s=0;$(window).on("scroll",function(){$(window).scrollTop()<s?"fixed"!=$("header").css("position")&&($("header").css({position:"fixed",top:-$("header").outerHeight(),backgroundColor:"#fff"}),$("header").animate({top:"0px"},500),$("#main").css("padding-top",$("header").outerHeight())):($("header").css({position:"relative",top:"0px"}),$("#main").css("padding-top","0px")),s=$(window).scrollTop()}),$(function(){function e(){var e=$(this),t=e.find(".modal-dialog");e.css("display","block"),t.css("margin-top",Math.max(0,($(window).height()-t.height())/2))}$(".modal").on("show.bs.modal",e),$(window).on("resize",function(){$(".modal:visible").each(e)})});var o=!0;$("#search-suggest-menu").mouseover(function(){o=!1}),$("#search-suggest-menu").mouseout(function(){o=!0});var a=null;$("input[name=keyword]").keyup(function(){null!=a&&clearTimeout(a),a=setTimeout(function(){a=null;var e=$("input[name=keyword]").val().trim();e.length>2?$.ajax({url:base_url+"ajax/suggest_search",type:"POST",dataType:"json",data:{keyword:e},success:function(e){$("#search-suggest-menu").html(e.content),""!==e.content.trim()?$("#search-suggest-menu").show():$("#search-suggest-menu").hide()}}):$("#search-suggest-menu").hide()},600)}),$("input[name=keyword]").blur(function(){o&&$("#search-suggest-menu").hide()}),$("input[name=keyword]").focus(function(){""!==$("#search-suggest-menu").html()&&$("#search-suggest-menu").show()}),$("input[name=keyword]").keypress(function(e){13==e.which&&searchMovie()});var i=!0;$("#search-suggest-home").mouseover(function(){i=!1}),$("#search-suggest-home").mouseout(function(){i=!0}),$("input[name=keyword-home]").keyup(function(){null!=a&&clearTimeout(a),a=setTimeout(function(){a=null;var e=$("input[name=keyword-home]").val().trim();e.length>2?$.ajax({url:base_url+"ajax/suggest_search",type:"POST",dataType:"json",data:{keyword:e},success:function(e){$("#search-suggest-home").html(e.content),""!==e.content.trim()?$("#search-suggest-home").show():$("#search-suggest-home").hide()}}):$("#search-suggest-home").hide()},600)}),$("input[name=keyword-home]").blur(function(){i&&$("#search-suggest-home").hide()}),$("input[name=keyword-home]").focus(function(){""!==$("#search-suggest-home").html()&&$("#search-suggest-home").show()}),$("input[name=keyword-home]").keypress(function(e){13==e.which&&searchMovieHome()}),$("#login-form").submit(function(e){$("#login-submit").prop("disabled",!0),$("#login-loading").show();var t=$(this).serializeArray(),s=$(this).attr("action");$.ajax({url:s,type:"POST",data:t,dataType:"json",success:function(e){e.status?(is_login=!0,$("#top-user").html(e.html),$("#pop-login").modal("hide")):($("#error-message").show(),$("#error-message").text(e.message),$("#login-submit").removeAttr("disabled"),$("#login-loading").hide())}}),e.preventDefault()}),$("#register-form").submit(function(e){$("#register-submit").prop("disabled",!0),$("#register-loading").show();var t=$(this).serializeArray(),s=$(this).attr("action");$.ajax({url:s,type:"POST",data:t,dataType:"json",success:function(e){if($(".error-block").hide(),e.status)is_login=!0,$("#top-user").html(e.html),$("#pop-register").modal("hide");else{for(var t in e.messages)$("#error-"+t).show(),$("#error-"+t).text(e.messages[t]);$("#register-submit").removeAttr("disabled"),$("#register-loading").hide(),grecaptcha.reset(recap_register)}}}),e.preventDefault()}),$("#forgot-form").submit(function(e){$("#forgot-submit").prop("disabled",!0),$("#forgot-loading").show();var t=$(this).serializeArray();$.ajax({url:base_url+"user/forgotPassword",type:"POST",data:t,dataType:"json",success:function(e){0==e.status&&($("#forgot-error-message").show(),$("#forgot-error-message").text(e.message)),1==e.status&&($("#forgot-success-message").show(),$("#forgot-success-message").text(e.message)),$("#forgot-submit").removeAttr("disabled"),$("#forgot-loading").hide()}}),e.preventDefault()}),$("#request-form").submit(function(e){$("#request-submit").prop("disabled",!0),$("#request-loading").show();var t=$(this).serializeArray();$.ajax({url:"/ajax/user_request",type:"POST",data:t,dataType:"json",success:function(e){if($(".error-block").hide(),0==e.status)for(var t in e.messages)$("#error-"+t).show(),$("#error-"+t).text(e.messages[t]);1==e.status&&($("#message-success").show(),setTimeout(function(){$("#message-success").hide()},5e3),document.getElementById("request-form").reset()),$("#request-submit").removeAttr("disabled"),$("#request-loading").hide(),grecaptcha.reset(recap_request)}}),e.preventDefault()})}),$("#donate-gift-card-form").submit(function(e){var t=$(this).serializeArray(),s=$(this).attr("action");$.ajax({url:s,type:"POST",data:t,dataType:"json",success:function(e){if($(".error-block").hide(),0==e.status)for(var t in e.messages)$("#error-"+t).show(),$("#error-"+t).text(e.messages[t]);1==e.status&&($("#message-success").show(),setTimeout(function(){$("#message-success").hide()},5e3),document.getElementById("donate-gift-card-form").reset())}}),e.preventDefault()}),$.cookie("subscribe")||setTimeout(function(){$("#pop-subc").modal("show"),$.cookie("subscribe",1,{expires:1,path:"/"})},1e4),$.cookie("subscribed")||$("#subs-block-home").show();var recap_request,recap_register,onloadCallback=function(){recap_register=grecaptcha.render("recaptcha-register",{sitekey:"6LdVwwkUAAAAAN-4dNTjOc7VUVLNxXvI8auolS4a"}),$("#recaptcha-request").length>0&&(recap_request=grecaptcha.render("recaptcha-request",{sitekey:"6LdVwwkUAAAAAN-4dNTjOc7VUVLNxXvI8auolS4a"}))};